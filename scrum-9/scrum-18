# SOP: Gunicorn Installation and Configuration Guide

| Created     | Version | Author         | Comment | Reviewer |
|-------------|---------|----------------|---------|----------|
| 14-04-2025  | V1      | Vardaan Saxena |         | Pritam   |

## 📌 Objective
This SOP provides a **step-by-step guide** to install and configure **Gunicorn**, a Python WSGI HTTP Server, commonly used to serve Python web applications like Flask or Django.

---

## 📚 Table of Contents

1. [What is Gunicorn?](#-what-is-gunicorn)
2. [Pre-requisites](#-1-pre-requisites)
3. [Install Gunicorn](#-2-install-gunicorn)
4. [Run Gunicorn with a Sample App](#-3-run-gunicorn-with-a-sample-app)
5. [Create a Gunicorn Systemd Service](#-4-create-a-gunicorn-systemd-service)
6. [Start and Enable the Service](#-5-start-and-enable-the-service)
7. [Verify the Setup](#-6-verify-the-setup)
8. [Best Practices](#-7-best-practices)
9. [Troubleshooting](#-8-troubleshooting)
10. [References](#-references)
11. [Contacts](#-contacts)

---

## 📖 What is Gunicorn?
**Gunicorn** (Green Unicorn) is a **Python WSGI HTTP server** for UNIX. It's a **production-grade** server used to run Python web apps behind a reverse proxy like Nginx.

> 🔧 Works with: Flask, Django, FastAPI, etc.

---

## 🧰 1. Pre-requisites

Ensure the following are available:
- Python 3.x
- `pip` (Python package manager)
- A Python web app (Flask/Django/etc.)

**Install Python & pip (if missing):**
```bash
sudo apt update
sudo apt install python3 python3-pip -y
```

---

## ⚙️ 2. Install Gunicorn

You can install Gunicorn **globally** or within a **virtual environment**:

### Option A: Global Installation
```bash
sudo pip3 install gunicorn
```

### Option B: Inside a Virtual Environment
```bash
python3 -m venv venv
source venv/bin/activate
pip install gunicorn
```

Verify the installation:
```bash
gunicorn --version
```

---

## 🚀 3. Run Gunicorn with a Sample App

### Flask Example:
Create a file named `app.py`:
```python
from flask import Flask
app = Flask(__name__)

@app.route("/")
def home():
    return "Hello from Gunicorn!"
```

Run with Gunicorn:
```bash
gunicorn --bind 0.0.0.0:8000 app:app
```

> `app:app` means: file name `app.py` and Flask app object `app`

---

## 🔧 4. Create a Gunicorn Systemd Service

Create the file:
```bash
sudo nano /etc/systemd/system/gunicorn.service
```

Paste the following:

```ini
[Unit]
Description=Gunicorn instance to serve myapp
After=network.target

[Service]
User=ubuntu
Group=www-data
WorkingDirectory=/home/ubuntu/myapp
Environment="PATH=/home/ubuntu/myapp/venv/bin"
ExecStart=/home/ubuntu/myapp/venv/bin/gunicorn --workers 3 --bind unix:myapp.sock -m 007 app:app

[Install]
WantedBy=multi-user.target
```

> ✅ Make sure to replace the **user, paths**, and **app name** with your actual setup

---

## 🟢 5. Start and Enable the Service

Reload systemd and start the Gunicorn service:
```bash
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
sudo systemctl start gunicorn
sudo systemctl enable gunicorn
```

Check status:
```bash
sudo systemctl status gunicorn
```

---

## 🔍 6. Verify the Setup

You can test if your Gunicorn socket or port is running:
```bash
ss -ltnp | grep gunicorn
```

If serving via a Unix socket (`.sock`), make sure Nginx or a reverse proxy is set up to forward traffic to it.

---

## 📌 7. Best Practices

- Use a **virtual environment** for clean dependency management.
- Use **Systemd service** to run Gunicorn as a daemon.
- Run Gunicorn **behind Nginx** for production (SSL, buffering, etc.).
- Monitor with `supervisor`, `systemctl`, or logging tools.

---

## 🧯 8. Troubleshooting

| Issue                                | Fix                                                  |
|-------------------------------------|-------------------------------------------------------|
| `gunicorn: command not found`       | Check if installed in correct environment             |
| `socket error / permission denied`  | Check file permissions, paths, user/group             |
| App not starting                    | Check `ExecStart` path, app object reference          |
| 502 Bad Gateway (via Nginx)         | Ensure Gunicorn is running and socket/port is valid   |

---

## 📂 References

- [Gunicorn Docs](https://docs.gunicorn.org/en/stable/run.html)
- [Flask + Gunicorn Tutorial](https://flask.palletsprojects.com/en/latest/deploying/gunicorn/)
- [Systemd Unit Files](https://www.freedesktop.org/software/systemd/man/systemd.service.html)

---

## 📇 Contacts

| Name           | Email Address                                 |
|----------------|-----------------------------------------------|
| Vardaan Saxena | vardaan.saxena.snaatak@mygurukulam.co         |
